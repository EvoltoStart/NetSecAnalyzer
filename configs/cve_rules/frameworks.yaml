service: Application Frameworks
rules:
  # Log4j CVE
  - service_pattern: "Log4j"
    version_pattern: "2.1"
    cve_id: "CVE-2021-44228"
    cvss: 10.0
    severity: "critical"
    title: "Log4Shell - Apache Log4j Remote Code Execution"
    description: "Apache Log4j2 <=2.14.1 JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints."
    solution: "Upgrade to Log4j 2.17.0 or later, or apply mitigation by setting log4j2.formatMsgNoLookups=true"
    affected_version: "Log4j 2.0-beta9 - 2.14.1"
    enabled: true

  # Spring CVE
  - service_pattern: "Spring"
    version_pattern: "5.3"
    cve_id: "CVE-2022-22965"
    cvss: 9.8
    severity: "critical"
    title: "Spring4Shell - Spring Framework RCE"
    description: "A Spring MVC or Spring WebFlux application running on JDK 9+ may be vulnerable to remote code execution (RCE) via data binding."
    solution: "Upgrade to Spring Framework 5.3.18, 5.2.20 or later"
    affected_version: "Spring Framework 5.3.0 - 5.3.17, 5.2.0 - 5.2.19"
    enabled: true

  # Struts CVE
  - service_pattern: "Struts"
    version_pattern: "2.5"
    cve_id: "CVE-2017-5638"
    cvss: 10.0
    severity: "critical"
    title: "Apache Struts2 Remote Code Execution"
    description: "The Jakarta Multipart parser in Apache Struts 2 has incorrect exception handling and error-message generation during file-upload attempts."
    solution: "Upgrade to Struts 2.3.32 or 2.5.10.1 or later"
    affected_version: "Struts 2.3.x < 2.3.32, 2.5.x < 2.5.10.1"
    enabled: true

  # Tomcat CVEs
  - service_pattern: "Tomcat"
    version_pattern: "Tomcat"
    cve_id: "CVE-2020-1938"
    cvss: 9.8
    severity: "critical"
    title: "Ghostcat - Apache Tomcat AJP File Read/Inclusion"
    description: "When using the Apache JServ Protocol (AJP), care must be taken when trusting incoming connections to Apache Tomcat. Tomcat treats AJP connections as having higher trust than HTTP connections."
    solution: "Upgrade to Tomcat 9.0.31, 8.5.51, 7.0.100 or later"
    affected_version: "Tomcat 9.0.0.M1 - 9.0.30, 8.5.0 - 8.5.50, 7.0.0 - 7.0.99"
    enabled: true

  - service_pattern: "Tomcat"
    version_pattern: "Tomcat"
    cve_id: "CVE-2019-0232"
    cvss: 8.1
    severity: "high"
    title: "Apache Tomcat CGI Servlet RCE"
    description: "When running on Windows with enableCmdLineArguments enabled, the CGI Servlet is vulnerable to Remote Code Execution due to a bug in the way the JRE passes command line arguments to Windows."
    solution: "Upgrade to Tomcat 9.0.18, 8.5.40, 7.0.94 or later"
    affected_version: "Tomcat 9.0.0.M1 - 9.0.17, 8.5.0 - 8.5.39, 7.0.0 - 7.0.93"
    enabled: true

  # Jenkins CVE
  - service_pattern: "Jenkins"
    version_pattern: "Jenkins"
    cve_id: "CVE-2019-1003000"
    cvss: 8.8
    severity: "high"
    title: "Jenkins Script Security Sandbox Bypass"
    description: "A sandbox bypass vulnerability in Jenkins Script Security Plugin allows attackers to execute arbitrary code in sandboxed scripts."
    solution: "Upgrade Jenkins and Script Security Plugin to latest version"
    affected_version: "Script Security Plugin 1.49 and earlier"
    enabled: true

  # WebLogic CVE
  - service_pattern: "WebLogic"
    version_pattern: "WebLogic"
    cve_id: "CVE-2020-14882"
    cvss: 9.8
    severity: "critical"
    title: "Oracle WebLogic Server Remote Code Execution"
    description: "Vulnerability in the Oracle WebLogic Server product allows unauthenticated attacker with network access via HTTP to compromise Oracle WebLogic Server."
    solution: "Apply Oracle security patches"
    affected_version: "WebLogic 10.3.6.0, 12.1.3.0, 12.2.1.3-4, 14.1.1.0"
    enabled: true

  # Docker CVE
  - service_pattern: "Docker"
    version_pattern: "Docker"
    cve_id: "CVE-2019-5736"
    cvss: 8.6
    severity: "high"
    title: "runc Container Breakout"
    description: "runc through 1.0-rc6, as used in Docker and other products, allows attackers to overwrite the host runc binary and consequently obtain host root access."
    solution: "Upgrade to Docker 18.09.2 or later"
    affected_version: "Docker < 18.09.2"
    enabled: true

  # Kubernetes CVE
  - service_pattern: "Kubernetes"
    version_pattern: "Kubernetes"
    cve_id: "CVE-2018-1002105"
    cvss: 9.8
    severity: "critical"
    title: "Kubernetes Privilege Escalation"
    description: "In Kubernetes versions 1.0.x, 1.1.x, 1.2.x, 1.3.x, 1.4.x, 1.5.x, 1.6.x, 1.7.x, 1.8.x, 1.9.x, 1.10.x, and 1.11.x, users that are authorized to make patch requests to the Kubernetes API Server can send a specially crafted patch of type 'json-patch' to escalate privileges."
    solution: "Upgrade to Kubernetes 1.10.11, 1.11.5, 1.12.3 or later"
    affected_version: "Kubernetes 1.0 - 1.10.10, 1.11.0 - 1.11.4, 1.12.0 - 1.12.2"
    enabled: true

